Search.setIndex({"docnames": ["README", "conf", "dataloader", "index", "main", "modules", "modules1", "quant_affine", "quant_model", "quant_utils", "vmodules", "vquant_kernel"], "filenames": ["README.md", "conf.rst", "dataloader.rst", "index.rst", "main.rst", "modules.rst", "modules1.rst", "quant_affine.rst", "quant_model.rst", "quant_utils.rst", "vmodules.rst", "vquant_kernel.rst"], "titles": ["VQuant\u91cf\u5316\u65b9\u6848", "&lt;no title&gt;", "dataloader.py", "Vquant\u9879\u76ee\u8bf4\u660e\u6587\u6863", "main.py", "vquant_kernel", "\u4ee3\u7801\u8bf4\u660e", "quant_affine.py", "quant_model.py", "quant_utils.py", "vmodules.py", "vquant_kernel package"], "terms": {"conda": 0, "creat": 0, "n": [0, 11], "vquant": [0, 10], "python": 0, "3": 0, "8": [0, 10], "activ": 0, "instal": 0, "pytorch": 0, "torchvis": 0, "torchaudio": 0, "cudatoolkit": 0, "11": 0, "1": [0, 11], "c": [0, 11], "nvidia": 0, "pip": 0, "pytorchcv": 0, "0": [0, 7, 10, 11], "51": 0, "The": [0, 7, 11], "weight": [0, 10], "should": [0, 7, 10, 11], "correctli": 0, "when": [0, 11], "infer": [0, 7], "i": [0, 2, 7, 11], "per": 0, "output": [0, 7, 10], "channel": 0, "affin": 0, "quantzat": 0, "same": [0, 11], "zeroq": 0, "gdfq": 0, "For": 0, "all": [0, 7, 10, 11], "result": [0, 11], "we": 0, "onli": [0, 7, 11], "set": [0, 7, 11], "min": [0, 7], "max": [0, 7], "rang": [0, 7], "input": [0, 2, 7, 10], "must": [0, 7], "tensor": [0, 7, 10], "element": 0, "have": [0, 7], "ONE": 0, "clip": 0, "method": 0, "bn": 0, "base": [0, 7, 10, 11], "from": 0, "dfq": 0, "wider": 0, "model": [0, 8, 9], "alpha": [0, 11], "under": 0, "bit": [0, 7, 10], "width": 0, "similar": 0, "aciq": 0, "first": [0, 7], "layer": [0, 10], "doe": 0, "need": [0, 7, 10, 11], "other": [0, 11], "framework": 0, "last": 0, "fc": 0, "us": [0, 7, 11], "8bit": 0, "lower": [0, 7], "than": [0, 2], "note": 0, "didn": 0, "t": [0, 7, 11], "after": 0, "averag": 0, "pool": 0, "procedur": 0, "involv": 0, "ani": 0, "real": 0, "dataset": [0, 2], "inform": 0, "data": [0, 2], "free": 0, "finish": 0, "befor": 0, "without": 0, "train": [0, 10], "valid": 0, "can": [0, 7], "runtim": 0, "howev": 0, "its": [0, 8], "test": [0, 4], "hyperparamet": 0, "fit": [], "pm": [], "2": [], "error": [], "present": [], "manuscript": [], "ablat": [], "studi": [], "reproduc": [], "gettestdata": 2, "imagenet": 2, "batch_siz": 2, "1024": 2, "path": [2, 9], "for_incept": 2, "fals": [2, 7, 10], "sourc": [2, 7, 8, 9, 10, 11], "get": 2, "testset": 2, "name": [2, 8, 10], "batch": 2, "size": 2, "random": 2, "whether": [2, 7, 11], "incept": 2, "becaus": 2, "ha": [2, 7, 11], "299": 2, "rather": 2, "224": 2, "vquant\u91cf\u5316\u65b9\u6848": 3, "environ": 3, "quantiz": [3, 7, 8, 10], "rule": 3, "\u4ee3\u7801\u8bf4\u660e": 3, "dataload": [3, 6], "py": [3, 6, 11], "main": [3, 6, 7], "quant_affin": [3, 6], "quant_model": [3, 6], "quant_util": [3, 6], "vmodul": [3, 6], "vquant_kernel": [3, 6], "packag": [3, 5, 6], "\u529f\u80fd1": 4, "\u8bbe\u7f6e\u53c2\u6570": 4, "\u529f\u80fd2": 4, "\u6267\u884c\u6d4b\u8bd5": 4, "quantized_model_": 4, "\u7ee7\u627f\u56fe": [], "asymmetricquantfunct": 7, "torch": [7, 10], "autograd": 7, "function": [7, 10, 11], "functionctx": 7, "\u7c7b": [7, 9, 10], "\u51fd\u6570": [7, 9, 10], "class": [7, 10], "arg": [7, 9, 10, 11], "kwarg": [7, 10], "given": [7, 10], "float": 7, "point": 7, "valu": [7, 10, 11], "current": [7, 11], "support": 7, "back": 7, "propag": 7, "\u8fd9\u91cc\u662f\u6fc0\u6d3b\u7684\u91cf\u5316\u90e8\u5206": [], "static": 7, "backward": 7, "ctx": 7, "grad_output": 7, "defin": [7, 10], "formula": 7, "differenti": 7, "oper": [7, 10], "mode": [7, 10], "automat": 7, "thi": [7, 10], "overridden": [7, 10], "subclass": [7, 10], "It": [7, 11], "accept": 7, "context": 7, "argument": 7, "follow": 7, "mani": 7, "forward": [7, 10], "return": 7, "none": [7, 10], "pass": [7, 10], "non": 7, "were": 7, "each": 7, "gradient": [7, 11], "w": 7, "r": 7, "correspond": 7, "If": 7, "an": [7, 11], "requir": [7, 11], "grad": [7, 11], "you": 7, "just": [7, 11], "retriev": 7, "save": 7, "dure": 7, "also": [7, 11], "attribut": 7, "needs_input_grad": 7, "tupl": 7, "boolean": 7, "repres": 7, "e": [7, 11], "g": [5, 7, 11], "true": [7, 10, 11], "comput": [7, 10, 11], "x": [7, 10, 11], "k": 7, "x_min": 7, "x_max": 7, "has_quant_weight": 7, "singl": [7, 8], "precis": [7, 8], "bound": [7, 10, 11], "adaptive_round": [7, 10], "n_min": [7, 10], "n_max": [7, 10], "\u91cf\u5316\u53c2\u6570\u8bbe\u7f6e": [], "asymmetric_linear_quantization_param": 7, "num_bit": 7, "saturation_min": 7, "saturation_max": 7, "integral_zero_point": 7, "sign": 7, "scale": 7, "factor": 7, "zeropoint": 7, "upper": 7, "clamp": 7, "inplac": 7, "linear_dequant": 7, "zero_point": 7, "map": 7, "integ": [7, 11], "fix": 7, "zero_pint": 7, "shift": 7, "linear_quant": 7, "\u7ee7\u627f\u5173\u7cfb": [7, 10], "quantize_model": 8, "recurs": 8, "pretrain": 8, "int8": 8, "set_first_last_lay": 8, "disable_input_quant": [9, 10], "disable_quant": [9, 10], "enable_quant": [9, 10], "get_ckpt_filenam": 9, "epoch": 9, "get_ckpt_path": [5, 9, 11], "get_log_filenam": 9, "set_quant": 9, "set_util_log": [5, 9, 11], "filenam": [9, 11], "tag_info": 9, "nn": 10, "modul": 10, "tensorquant": 10, "activationquant": 10, "linearquant": 10, "conv2dquant": 10, "wbit": 10, "abit": 10, "perform": 10, "everi": 10, "call": [7, 10, 11], "although": 10, "recip": 10, "within": 10, "one": 10, "instanc": 10, "afterward": 10, "instead": 10, "sinc": 10, "former": 10, "take": 10, "care": 10, "run": 10, "regist": 10, "hook": 10, "while": 10, "latter": 10, "silent": 10, "ignor": 10, "them": 10, "bool": 10, "convolut": 10, "set_param": 10, "conv": 10, "linear": 10, "129": 10, "5": 10, "128": 10, "is_sign": 10, "is_en": 10, "is_input": 10, "convert_tensor": 10, "tensor_forward": 10, "image_s": 10, "updata_packed_el": 10, "updata_sign": 10, "fixnu": 11, "eh": [5, 11], "": 11, "h": 11, "uniw": 11, "sigmaw": 11, "nu": 11, "beta": 11, "n_r": 11, "n_l": 11, "distr": 11, "compute_gradi": [5, 11], "grandtyp": 11, "cost": [5, 11], "costtyp": 11, "h_initi": [5, 11], "keepconvex": [], "lbfgs_optim": [5, 11], "p": 11, "max_iter": 11, "100": 11, "toler": 11, "1e": 11, "06": 11, "nearc": [5, 11], "nu_plot": [5, 11], "testnam": 11, "optim": [5, 7, 11], "learning_r": 11, "epsilon": 11, "nudistr": 11, "rate": 11, "updat": 11, "l": 11, "delta_nu": [], "update_h": [5, 11], "vround": [5, 11], "interv": 11, "calculate_c": [5, 11], "calculate_c1": [5, 11], "calculate_x": [5, 11], "j": 11, "side": 11, "calculate_x_j": [5, 11], "calculate_onesid": [5, 11], "n_side": 11, "found0": [5, 11], "onedimc": [5, 11], "plot_lines_xj": [5, 11], "co": 11, "file": 11, "xlabl": 11, "ylabl": 11, "y": 11, "show": 11, "activation_qu": 7, "make": 7, "some": [7, 11], "paramet": [7, 11], "As": 8, "\u672c\u6a21\u5757\u5305\u62ecvquants\u8fd0\u884c\u65f6\u9700\u8981\u7684\u5de5\u5177\u51fd\u6570": 9, "number": 11, "desid": 11, "distribut": 11, "mixgrand": 11, "mean": 11, "consid": 11, "initi": 11, "outset": 11, "equat": 11, "solv": 11, "approach": 11, "now": [], "simpli": 11, "add": 11, "code": 11, "sigma": 11, "obtain": 11, "partit": 11, "p_i": 11, "_": 11, "implement": 11, "what": 11, "kind": 11, "bfg": 11, "methond": 11, "round": 11, "x_ij": 11, "x_j": 11, "determin": 11, "retain": 11, "index": 11, "next": 11, "breakpoint": 11, "purpos": 11, "simpler": 11, "doesn": 11, "calcul": 11, "applic": 11, "learn": 11, "rel": 11, "small": 11, "finli": 11, "step": 11, "depend": 11, "aforement": 11, "fuction": 11, "There": 11, "ar": 11, "two": 11, "case": 11, "left": 11, "right": 11, "select": 11, "find": 11, "inner": 11, "plot": 11, "convex": 11, "u": 11, "descent": 11, "object": 11, "quantifi": 11, "varianc": 11, "choos": 11, "type": 11, "adjust": 11, "log": 11, "relat": 11, "anoth": 11, "suggest": 11}, "objects": {"": [[2, 0, 0, "-", "dataloader"], [7, 0, 0, "-", "quant_affine"], [8, 0, 0, "-", "quant_model"], [9, 0, 0, "-", "quant_utils"], [4, 1, 1, "", "test"], [10, 0, 0, "-", "vmodules"]], "dataloader": [[2, 1, 1, "", "getTestData"]], "quant_affine": [[7, 2, 1, "", "AsymmetricQuantFunction"], [7, 1, 1, "", "adaptive_round"], [7, 1, 1, "", "asymmetric_linear_quantization_params"], [7, 1, 1, "", "clamp"], [7, 1, 1, "", "linear_dequantize"], [7, 1, 1, "", "linear_quantize"]], "quant_affine.AsymmetricQuantFunction": [[7, 3, 1, "", "backward"], [7, 3, 1, "", "forward"]], "quant_model": [[8, 1, 1, "", "quantize_model"], [8, 1, 1, "", "set_first_last_layer"]], "quant_utils": [[9, 1, 1, "", "disable_input_quantization"], [9, 1, 1, "", "disable_quantization"], [9, 1, 1, "", "enable_quantization"], [9, 1, 1, "", "get_ckpt_filename"], [9, 1, 1, "", "get_ckpt_path"], [9, 1, 1, "", "get_log_filename"], [9, 1, 1, "", "set_quantizer"], [9, 1, 1, "", "set_util_logging"], [9, 1, 1, "", "tag_info"]], "vmodules": [[10, 2, 1, "", "ActivationQuantizer"], [10, 2, 1, "", "Conv2dQuantizer"], [10, 2, 1, "", "LinearQuantizer"], [10, 2, 1, "", "Quantizer"], [10, 2, 1, "", "TensorQuantizer"]], "vmodules.ActivationQuantizer": [[10, 3, 1, "", "forward"], [10, 4, 1, "", "training"]], "vmodules.Conv2dQuantizer": [[10, 3, 1, "", "forward"], [10, 3, 1, "", "set_param"], [10, 4, 1, "", "training"]], "vmodules.LinearQuantizer": [[10, 3, 1, "", "forward"], [10, 3, 1, "", "set_param"], [10, 4, 1, "", "training"]], "vmodules.Quantizer": [[10, 3, 1, "", "adaptive_round"], [10, 3, 1, "", "convert_tensor"], [10, 3, 1, "", "disable_input_quantization"], [10, 3, 1, "", "disable_quantization"], [10, 3, 1, "", "enable_quantization"], [10, 3, 1, "", "tensor_forward"], [10, 4, 1, "", "training"], [10, 3, 1, "", "updata_packed_element"], [10, 3, 1, "", "updata_signed"]], "vmodules.TensorQuantizer": [[10, 3, 1, "", "forward"], [10, 4, 1, "", "training"]], "vquant_kernel": [[11, 0, 0, "-", "fixnu"], [11, 0, 0, "-", "interval"]], "vquant_kernel.fixnu": [[11, 1, 1, "", "Eh"], [11, 1, 1, "", "G"], [11, 1, 1, "", "compute_gradient"], [11, 1, 1, "", "cost"], [11, 1, 1, "", "get_ckpt_path"], [11, 1, 1, "", "h_initial"], [11, 1, 1, "", "lbfgs_optimizer"], [11, 1, 1, "", "nearC"], [11, 1, 1, "", "nu_plot"], [11, 1, 1, "", "optimize"], [11, 1, 1, "", "set_util_logging"], [11, 1, 1, "", "update_h"], [11, 1, 1, "", "vround"]], "vquant_kernel.interval": [[11, 1, 1, "", "calculate_C"], [11, 1, 1, "", "calculate_C1"], [11, 1, 1, "", "calculate_X"], [11, 1, 1, "", "calculate_X_j"], [11, 1, 1, "", "calculate_oneside"], [11, 1, 1, "", "found0"], [11, 1, 1, "", "onedimC"], [11, 1, 1, "", "plot_lines_Xj"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"vquant\u91cf\u5316\u65b9\u6848": 0, "environ": 0, "quantiz": 0, "rule": 0, "dataload": 2, "py": [2, 4, 7, 8, 9, 10], "thi": [], "i": [], "document": [], "vquant": [], "librari": [], "content": [], "main": 4, "\u4ee3\u7801\u8bf4\u660e": 6, "quant_affin": 7, "quant_model": 8, "quant_util": 9, "vmodul": 10, "vquant_kernel": [5, 11], "packag": 11, "conf": [], "modul": [], "fixnu": [], "interv": [], "\u76ee\u5f55": 3, "vquant\u9879\u76ee\u8bf4\u660e\u6587\u6863": 3}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 58}, "alltitles": {"main.py": [[4, "main-py"]], "Vquant\u9879\u76ee\u8bf4\u660e\u6587\u6863": [[3, "vquant"]], "\u76ee\u5f55\uff1a": [[3, null]], "vquant_kernel": [[5, "vquant-kernel"]], "\u4ee3\u7801\u8bf4\u660e": [[6, "id1"]], "VQuant\u91cf\u5316\u65b9\u6848": [[0, "vquant"]], "Environment": [[0, "environment"]], "Quantization Rules": [[0, "quantization-rules"]], "dataloader.py": [[2, "module-dataloader"]], "quant_affine.py": [[7, "quant-affine-py"]], "quant_model.py": [[8, "module-quant_model"]], "quant_utils.py": [[9, "quant-utils-py"]], "vmodules.py": [[10, "vmodules-py"]], "vquant_kernel package": [[11, "vquant-kernel-package"]]}, "indexentries": {"asymmetricquantfunction (class in quant_affine)": [[7, "quant_affine.AsymmetricQuantFunction"]], "adaptive_round() (in module quant_affine)": [[7, "quant_affine.adaptive_round"]], "asymmetric_linear_quantization_params() (in module quant_affine)": [[7, "quant_affine.asymmetric_linear_quantization_params"]], "backward() (quant_affine.asymmetricquantfunction static method)": [[7, "quant_affine.AsymmetricQuantFunction.backward"]], "clamp() (in module quant_affine)": [[7, "quant_affine.clamp"]], "forward() (quant_affine.asymmetricquantfunction static method)": [[7, "quant_affine.AsymmetricQuantFunction.forward"]], "linear_dequantize() (in module quant_affine)": [[7, "quant_affine.linear_dequantize"]], "linear_quantize() (in module quant_affine)": [[7, "quant_affine.linear_quantize"]], "module": [[7, "module-quant_affine"], [8, "module-quant_model"], [9, "module-quant_utils"], [10, "module-vmodules"], [11, "module-vquant_kernel.fixnu"], [11, "module-vquant_kernel.interval"]], "quant_affine": [[7, "module-quant_affine"]], "quant_model": [[8, "module-quant_model"]], "quantize_model() (in module quant_model)": [[8, "quant_model.quantize_model"]], "set_first_last_layer() (in module quant_model)": [[8, "quant_model.set_first_last_layer"]], "disable_input_quantization() (in module quant_utils)": [[9, "quant_utils.disable_input_quantization"]], "disable_quantization() (in module quant_utils)": [[9, "quant_utils.disable_quantization"]], "enable_quantization() (in module quant_utils)": [[9, "quant_utils.enable_quantization"]], "get_ckpt_filename() (in module quant_utils)": [[9, "quant_utils.get_ckpt_filename"]], "get_ckpt_path() (in module quant_utils)": [[9, "quant_utils.get_ckpt_path"]], "get_log_filename() (in module quant_utils)": [[9, "quant_utils.get_log_filename"]], "quant_utils": [[9, "module-quant_utils"]], "set_quantizer() (in module quant_utils)": [[9, "quant_utils.set_quantizer"]], "set_util_logging() (in module quant_utils)": [[9, "quant_utils.set_util_logging"]], "tag_info() (in module quant_utils)": [[9, "quant_utils.tag_info"]], "activationquantizer (class in vmodules)": [[10, "vmodules.ActivationQuantizer"]], "conv2dquantizer (class in vmodules)": [[10, "vmodules.Conv2dQuantizer"]], "linearquantizer (class in vmodules)": [[10, "vmodules.LinearQuantizer"]], "quantizer (class in vmodules)": [[10, "vmodules.Quantizer"]], "tensorquantizer (class in vmodules)": [[10, "vmodules.TensorQuantizer"]], "adaptive_round() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.adaptive_round"]], "convert_tensor() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.convert_tensor"]], "disable_input_quantization() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.disable_input_quantization"]], "disable_quantization() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.disable_quantization"]], "enable_quantization() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.enable_quantization"]], "forward() (vmodules.activationquantizer method)": [[10, "vmodules.ActivationQuantizer.forward"]], "forward() (vmodules.conv2dquantizer method)": [[10, "vmodules.Conv2dQuantizer.forward"]], "forward() (vmodules.linearquantizer method)": [[10, "vmodules.LinearQuantizer.forward"]], "forward() (vmodules.tensorquantizer method)": [[10, "vmodules.TensorQuantizer.forward"]], "set_param() (vmodules.conv2dquantizer method)": [[10, "vmodules.Conv2dQuantizer.set_param"]], "set_param() (vmodules.linearquantizer method)": [[10, "vmodules.LinearQuantizer.set_param"]], "tensor_forward() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.tensor_forward"]], "training (vmodules.activationquantizer attribute)": [[10, "vmodules.ActivationQuantizer.training"]], "training (vmodules.conv2dquantizer attribute)": [[10, "vmodules.Conv2dQuantizer.training"]], "training (vmodules.linearquantizer attribute)": [[10, "vmodules.LinearQuantizer.training"]], "training (vmodules.quantizer attribute)": [[10, "vmodules.Quantizer.training"]], "training (vmodules.tensorquantizer attribute)": [[10, "vmodules.TensorQuantizer.training"]], "updata_packed_element() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.updata_packed_element"]], "updata_signed() (vmodules.quantizer method)": [[10, "vmodules.Quantizer.updata_signed"]], "vmodules": [[10, "module-vmodules"]], "eh() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.Eh"]], "g() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.G"]], "calculate_c() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.calculate_C"]], "calculate_c1() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.calculate_C1"]], "calculate_x() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.calculate_X"]], "calculate_x_j() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.calculate_X_j"]], "calculate_oneside() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.calculate_oneside"]], "compute_gradient() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.compute_gradient"]], "cost() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.cost"]], "found0() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.found0"]], "get_ckpt_path() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.get_ckpt_path"]], "h_initial() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.h_initial"]], "lbfgs_optimizer() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.lbfgs_optimizer"]], "nearc() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.nearC"]], "nu_plot() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.nu_plot"]], "onedimc() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.onedimC"]], "optimize() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.optimize"]], "plot_lines_xj() (in module vquant_kernel.interval)": [[11, "vquant_kernel.interval.plot_lines_Xj"]], "set_util_logging() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.set_util_logging"]], "update_h() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.update_h"]], "vquant_kernel.fixnu": [[11, "module-vquant_kernel.fixnu"]], "vquant_kernel.interval": [[11, "module-vquant_kernel.interval"]], "vround() (in module vquant_kernel.fixnu)": [[11, "vquant_kernel.fixnu.vround"]]}})